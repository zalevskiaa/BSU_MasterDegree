\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[english, russian]{babel}
\usepackage[margin=0.5in]{geometry}
\usepackage{paralist}
\usepackage{amsthm, amsmath, amsfonts, amssymb}
\usepackage{mathtools} % \mathclap
\usepackage{bm}
\usepackage{dsfont}
\usepackage{hyperref}
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{comment}
\usepackage{xcolor, colortbl}
\usepackage{xifthen, xspace}
\usepackage{caption, subcaption}

\usepackage{sectsty}
\subsectionfont{\normalsize\color{red}}

\title{Домашнее задание №2 по курсу \\ <<Математическая Статистика в Машинном Обучении>>}
\author{Школа Анализа Данных}
\date{}

\renewenvironment{itemize}[1]{\begin{compactitem}#1}{\end{compactitem}}
\renewenvironment{enumerate}[1]{\begin{compactenum}#1}{\end{compactenum}}
\renewenvironment{description}[0]{\begin{compactdesc}}{\end{compactdesc}}


\begin{document}
\input{commands}
\maketitle



\subsection*{Задачи}
\subsubsection*{Задача 1 [4 балла]}
Пусть $n_1$ --- количество людей, которые получили лечение по методике 1, а $n_2$ --- количество людей, которые получили лечение по методике 2. Обозначим через $X_1$ --- количество людей, получивших лечение по методике 1, на которых эта методика повлияла положительно. Аналогично, обозначим через $X_2$ --- количество людей, получивших лечение по методике 2, на которых эта методика повлияла положительно. Предположим, что $X_1 \sim \Binomial(n_1,p_1)$ и $X_2\sim \Binomial(n_2,p_2)$. Положим $\psi = p_1-p_2$.
\begin{itemize}
	\item[(a)] Найдите MLE-оценку $\mlepsi$ для параметра $\psi$.
	\item[(b)] Найдите информационную матрицу Фишера $I(p_1,p_2)$.
	\item[(c)] Используя многопараметрический дельта-метод найдите асимптотическую стандартную ошибку для $\mlepsi$.
	\item[(d)] Допустим, что $n_1=n_2=200$, и конкретные значения случайных величин $X_1$ и $X_2$ равны $160$ и $148$ соответственно. Чему в этом случае равна оценка  $\mlepsi$. Найдите приблизительный (асимптотический) 90\%-ый доверительный интервал для $\psi$, используя (а) многопараметрический дельта-метод и (б) параметрический бутстреп.
\end{itemize}

\subsubsection*{Задача 2 [2 балла]}
Пусть $\boldX =\{X_1,\ldots,X_n\} \sim \Poisson(\lambda)$.
\begin{itemize}
	\item Постройте оценки $\tillambda$ параметра $\lambda$ с помощью метода моментов с использованием пробных функций $g_1(x) = x$ и $g_2(x) = x^2$.
	\item Постройте оценку $\hatlambda$ параметра $\lambda$ с помощью метода максимального правдоподобия. Найдите информацию Фишера $I_{X}(\lambda)$. Является ли оценка $\hatlambda$ эффективной?
\end{itemize}

\subsubsection*{Задача 3 [4 балла]}
Пусть $\boldX =\{X_1,\dots,X_n\} \sim \Pareto(\theta, \nu)$, $\theta > 0$, $\nu > 0$, с функцией плотности
$$
f_{\theta, \nu}(x) =
\begin{cases}
	\frac{\theta\nu^{\theta}}{x^{\theta+1}}, \quad & x \ge \nu,\\
	0, \quad & x < \nu
\end{cases}
$$
\begin{itemize}
	\item[a)] Найдите MLE-оценки $\hattheta$ и $\hat \nu$ для параметров $\theta$ и $\nu$.
	\item[c)] Пусть параметр $\nu$ известен. Найдите истинные значения $\Exp_{\theta}[\hat{\theta}]$ и $\Var_{\theta}[\hat{\theta}]$ как функции параметров $\theta$, $\nu$ и размера выборки $n$.
	\textit{Подсказка: следует использовать тот факт, что логарифм от случайной величины с распределением Парето, имеет экспоненциальное распределение.}
	\item[b)] Пусть параметр $\nu$ известен. Найдите асимптотическое распределение оценки $\hattheta$ с помощью дельта-метода.
	\item[d)] Пусть параметр $\nu$ известен. Найдите информацию Фишера $I_X(\theta)$. Является ли MLE-оценка параметра $\hat{\theta}$ эффективной?
\end{itemize}

\subsubsection*{Задача 4 [4 балла]}
Пусть $\boldX = \{X_1,\ldots,X_n\} \sim \Uniform(0,\theta)$, $Y = \max\{X_1,\ldots,X_n\}$.  Необходимо протестировать основную гипотезу $H_0:\theta = 1/2$ против альтернативы $H_1: \theta > 1/2$. В данном случае нельзя использовать тест Вальда, так как $Y$ при $n\to\infty$ не сходится к нормальному распределению. Допустим, что мы будем использовать следующее правило: гипотеза $H_0$ отвергается, если $Y > c$. 
\begin{itemize}
	\item[(a)] Найдите функцию мощности для данного теста.
	\item[(b)] При каком значении параметра $c$ размер теста будет равен $0.05$?
	\item[(c)] Каково значение $\pvalue$, если размер выборки $n = 20$ и $Y = 0.48$? Что можно сказать о гипотезе $H_0$?
	\item[(d)] Каково значение $\pvalue$, если размер выборки $n = 20$ и $Y = 0.52$? Что можно сказать о гипотезе $H_0$?
\end{itemize}

\subsubsection*{Задача 5 [1 балл]}
Пусть $\boldX = \{X_1,\dots,X_n\} \sim \Exponential(\theta)$. Постройте критерий отношения правдоподобий для проверки гипотезы $H_0: \theta = \theta_0$ vs $H_1 : \theta > \theta_0$.

\subsubsection*{Задача 6 [3 балла]}
Пусть $\boldX = \{X_1,\ldots,X_n\} \sim \Normal(\mu,\sigma^2)$, где параметр $\mu$ известен. Требуется протестировать гипотезу $H_0\colon \sigma = \sigma_0$ против альтернативы $H_1 \colon \sigma \neq \sigma_0$.
\begin{itemize}
	\item Постройте критерий отношения правдоподобий для различения гипотез $H_0$ и $H_1$.
	\item Постройте критерий Вальда для различения гипотез $H_0$ и $H_1$.
	\item Сравните аналитически полученные критерии.
	%Сравнить (как аналитически, так и экспериментально) полученный тест с тестом Вальда для различения этих гипотез.
\end{itemize}

\textit{Примечание.} Аналитическое сравнение тестов подразумевает доказательство их (асимптотической) эквивалентности или неэквивалентности, где под эквивалентностью понимается идентичность выносимых тестами решений.


\subsubsection*{Задача 7 [2 балла]}
Пусть $\boldX = \{X_1,\dots,X_n\}$ --- выборка н.о.р. с.в. со следующей функцией плотности:
$$
f(x, \theta) = \begin{cases}
	c(\theta)d(x), &a \leqslant x \leqslant b(\theta) \\
	0, &\text{ иначе }
\end{cases}
$$
где $b(\theta)$ --- монотонно возрастающая функция одного аргумента.

\begin{enumerate}
	\item[(a)] Построить статистику отношения правдоподобий $\lambda$ для тестирования гипотезы $H_0: \theta = \theta_0$ vs $H_1: \theta \neq \theta_0$
	\item[(b)] Найти распределение статистики $\lambda$ при выполнении $H_0$ для следующей функции плотности:
	$$
	f(x, \theta) = \begin{cases}
		\frac{2x}{\theta^2}, \quad &0 \leqslant x \leqslant \theta \\
		0, \quad &\text{иначе}
	\end{cases}
	$$
\end{enumerate}

\subsubsection*{Задача 8 [2 балла]}
Найдите наилучшую критическую область (НКО) для проверки гипотезы $H_0 \colon \Uniform[-a, a]$ против гипотезы $H_1 \colon \Normal(0, \sigma^2)$ по одному
наблюдению $(n = 1)$ при уровне значимости $\alpha = 0.1$. Найдите мощность полученного критерия.

\subsubsection*{Задача 9 [2 балла]}
Проверяются гипотезы о плотности $f$ распределения наблюдений $\boldX = \{X_1,\dots,X_n\}$: гипотеза $H_0\colon f = f_0$ против альтернативы $H_1\colon f = f_1$, где
\begin{gather*}
	f_1(x) = 
	\begin{cases}
		1, &x \in [0,1],\\
		0, &x \notin [0, 1],
	\end{cases}
	\qquad
	f_2(x)=
	\begin{cases}
		2x, &x \in [0, 1], \\
		0, &x \notin [0, 1].
	\end{cases}
\end{gather*}
Построить наиболее мощный критерий размера $\alpha$ при $n = 1$ и $n = 2$.

\subsubsection*{Задача 10 [2 балла]}
В процессе настольной игры у игроков возникло подозрение, что два кубика, которые шли в комплекте с игрой, несимметричны. Поэтому, начиная с некоторого момента, они начали записывать результаты бросков. В каждом броске участвуют оба кубика. Результаты приведены в таблице.
\begin{table}[h]
	\centering
	\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|c|}
		\hline
		Сумма очков & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12\\ \hline
		Количество бросков & 2 & 4 & 20 & 18 & 34 & 41 & 32 & 26 & 16 & 9 & 12 \\
		\hline
	\end{tabular}
\end{table}

Проверьте гипотезу о том, что оба кубика симметричны на уровне значимости $\alpha = 0.05$. Найдите p-value.

\subsubsection*{Задача 11 [2 балла]}
Предположим, что у нас есть 10 статей, написанных автором, скрывающемся под псевдонимом. Мы подозреваем, что эти статьи на самом деле написаны некоторым известным писателем. Чтобы проверить эту гипотезу, мы подсчитали доли четырехбуквенных слов в 8-и сочинениях подозреваемого нами автора:
$$
.224~ .261~ .216~ .239~ .229~ .228~ .234~ .216~
$$
В 10 сочинениях, опубликованных под псевдонимом, доли четырехбуквенных слов равны
$$
.207~ .204~ .195~ .209~ .201~ .206~ .223~ .222~ .219~ .200
$$
\begin{itemize}
	\item Используйте критерий Вальда. Найдите $\pvalue$ и 95\%-ый доверительный интервал для разницы средних значений. Какой вывод можно сделать исходя из найденных значений?
	\item Используйте критерий перестановок. Каково в этом случае значение $\pvalue$. Какой вывод можно сделать?
\end{itemize}


\subsubsection*{Задача 12 [2 балла]}
Маршрут грузового состава начинается в пункте $A$ и последовательно проходит через пункты $B_0$, $B_1$ и т.д. По прибытии в очередной пункт те составы, которые направлялись в этот пункт, отцепляются. Очередной состав из 500 грузовых вагонов отправился из пункта $A$ вдоль пунктов $B_0$, $B_1$, \dots. В таблице приведено количество отцепленных составов в каждом из пунктов (последним пунктом в данном случае оказался пункт $B_9$).

\begin{table}[!h]
	\centering
	\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
		\hline
		Пункт & $B_0$  & $B_1$  & $B_2$   & $B_3$   & $B_4$   & $B_5$  & $B_6$  & $B_7$ & $B_8$ & $B_9$ \\ \hline
		Количество составов & 15 & 55 & 126 & 110 & 113 & 49 & 20 & 9 & 2 & 1 \\
		\hline
	\end{tabular}
\end{table}

Возникло предположение, что распределение грузовых составов по пунктам назначения можно описать некоторым дискретным распределением, где $P(X = B_i)$ --- вероятность того, что состав направляется в пункт $B_i$. В рамках данного предположения требуется провести проверку следующих гипотез на уровне значимости $\alpha = 0.05$ и найти p-value:
\begin{enumerate}
	\item $\boldX \sim \Poisson(\theta)$, т.е. $P(X = B_j) = e^{-\theta} \frac{\theta^j}{j!}$, где $j \ge 0$.
	\item $\boldX \sim \Binomial(m, p)$, т.е. $P(X = B_j) = C^j_m p^j (1-p)^{m - j}$, где $j \in \{0, \dots, 9\}$ и $m = 9$.
\end{enumerate}

\textit{Подсказка. Воспользуйтесь параметрическим критерием хи-квадрат.}

\end{document}